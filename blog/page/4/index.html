
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>iwantmyreal.name</title>
  <meta name="author" content="Sam Davies">

  
  <meta name="description" content="This post was originally planned to be about how I’ve adapted the pointer
arithmetic used with standard data a fairly standard data structure to work &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://iwantmyreal.name//blog/page/4">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="iwantmyreal.name" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:200,300,400' rel='stylesheet' type='text/css'>
<link href="//netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css" rel="stylesheet">
<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-34836648-1']);
    _gaq.push(['_trackPageview']);

    setTimeout("_gaq.push(['_trackEvent', '15_seconds', 'read'])", 15000);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   class="no-sidebar"  >
  <header role="banner"><hgroup>
  <h2>
    <a href="/">
      <img src="http://www.gravatar.com/avatar/ddd6d3bac7772fa67fc5e312a18bdaec?s=150" />
    </a>
  </h2>
  <h1>iwantmyreal.name</h1>

</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/about">About</a></li>
  <li class="icons">
    <a href="https://twitter.com/iwantmyrealname"><i class="icon-twitter"></i></a>
    <a href="https://plus.google.com/101617378418592701939"><i class="icon-google-plus"></i></a>
    <a href="https://app.net/samd"><i class="icon-adn"></i></a>
    <a href="http://stackoverflow.com/users/1127633/sammyd"><i class="icon-stackexchange"></i></a>
    <a href="https://github.com/sammyd"><i class="icon-github"></i></a>
    <a href="https://bitbucket.org/sammyd"><i class="icon-bitbucket"></i></a>
  </li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/09/29/a-faster-array-in-objective-c/">A Faster Array in Objective-c</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-09-29T15:50:00+02:00" pubdate data-updated="true">Sep 29<sup>th</sup>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>This post was originally planned to be about how I’ve adapted the pointer
arithmetic used with standard data a fairly standard data structure to work
well with <code>NSMutableData</code> in objective-C. However, in making a sample project
to demonstrate this, I’ve expanded it a little to speeding up a very specific
type of array in objective-C.</p>

<h2 id="motivation-in-image-processing">Motivation in image processing</h2>

<p>I have been working recently on some image processing algorithms, one of which
required a priority queue of pixel locations. Now, this essentially requires a
list of integers, but since images have lots of pixels, it’s a very long list.
<code>NSArray</code> is a really useful all-purpose collection class used an awful lot
in objective-C. The one ‘restriction’ is that it is a collection of objects - 
it’s not possible to collect primitives in an NSArray without wrapping them in
an object. <code>NSNumber</code> is an object which represents all the different number
types and, more often than not, wrapping your numbers in this is the best way
to go. However, I mentioned that I want to build a list of a large number of
integers (think tens of millions). At this point, the overhead of wrapping
integers in <code>NSNumber</code> to put them in an <code>NSArray</code> becomes significant.</p>

<p>In the past, when doing image processing work, it is at this point I would
drop down to C (from python, matlab, ruby etc) and use low-level memory management
functionality to exactly create the data structures as expected. This is also
an option when using objective-C - it’s just a superset of C, so <code>malloc()</code> and
it’s associated functionality are available to use. However, in using this
we loose all of the memory management functionality made available by
objective-C. There is another way though - <code>NSMutableData</code>.</p>

<h2 id="nsmutabledata-as-a-chunk-of-memory">NSMutableData as a chunk of memory</h2>

<p><code>NSMutableData</code> is a class which provides the user with a writeable contiguous block of
memory of a given size. It inherits from <code>NSObject</code> so the memory management
of reference counting and autorelease pools comes for free. It also has the
advantage that we can ask for the block of memory to be dynamically resized and
iOS will take care of this for us. There is one proviso with this - and that is
that iOS reserves the right to move our block of data (primarily when resize
is requested). This makes perfect sense, but does cause some issues with
standard pointer-based data structures.</p>

<p>In this post I’ll describe how to implement a basic linked-list of integers using
<code>NSMutableData</code> and compare its performance to that of an <code>NSMutableArray</code>
based list.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2012/09/29/a-faster-array-in-objective-c/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/09/23/measuring-the-temperature-with-an-arduino-and-a-thermistor/">Measuring the Temperature With an Arduino and a Thermistor</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-09-23T22:19:00+02:00" pubdate data-updated="true">Sep 23<sup>rd</sup>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I’ve written a couple of previous posts about reading the temperature from
and Arduino, storing it in the cloud-based time-series storage engine
<a href="http://tempo-db.com/">TempoDB</a>, and visualising it. However, I haven’t
explained in any detail how to use an Arduino to actually measure the
temperature.</p>

<p>There are several methods available to you - including using digital sensor
chips, some of which just record temperature, some which include other
environmental data such as humidity, and thermocouples, which can be used to
measure extreme temperatures. However, the simplest technique is to
use a thermistor.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2012/09/23/measuring-the-temperature-with-an-arduino-and-a-thermistor/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/09/16/visualising-conair-data-with-cubism-dot-js/">Visualising ConAir Data With Cubism.js</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-09-16T22:38:00+02:00" pubdate data-updated="true">Sep 16<sup>th</sup>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>This post is part of a series of blog posts detailing how I built a system
which records the temperature in our office. The parts are as follows:</p>

<ul>
  <li><a href="/blog/2012/09/23/measuring-the-temperature-with-an-arduino-and-a-thermistor/">Measuring temperature with an Arduino</a>
describes how to use an Arduino and a thermistor to record the temperature.</li>
  <li><a href="/blog/2012/09/14/conair-the-quest-for-reasonable-office-air-con/">ConAir</a>
gives an overview of the motivation behind the project, and runs through the
process of taking the readings from the arduino and publishes them to a TempoDB
database on the internet.</li>
  <li>This post describes building a proxy webservice for the TempoDB database, and
then visualising the temperature data using cubism.js</li>
  <li><a href="/blog/2012/12/11/an-ios-app-for-plotting-live-data-conair-ios/">iOS App</a>
describes building an iOS app which pulls the data from the webservice created
in this app and uses ShinobiCharts to plot the result.</li>
</ul>

<hr />

<p>Hot on the tail of being able to record temperature readings from the
Arduino in the office, we can get some charting on the go.</p>

<p>This post describes building a <a href="http://square.github.com/cubism">cubism.js</a>
front end to a <a href="http://tempo-db.com/">TempoDB</a> API proxy we implement in
Sinatra. You can see the result running live on heroku at
<a href="http://sl-conair.herokuapp.com/">sl-conair</a>, and there’s a screenshot
below in case we’re working on the electronics and there is no data:</p>

<p><img src="/images/2012-09-16-sl-conair.png" /></p>

<p>We have been using <a href="http://tempo-db.com/">TempoDB</a> to store the temperature
data points - it has a great API for querying your dataset, including
rollups, which are able to summarise your data at a resolution of your choice.
Unfortunately, TempoDB doesn’t yet allow public access to datasets - the
API requires authentication for both read and write. Therefore the first
part of this stage will be to build a proxy for the TempoDB API. We then
use Cubism.js to interface this proxied API.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2012/09/16/visualising-conair-data-with-cubism-dot-js/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/09/14/conair-the-quest-for-reasonable-office-air-con/">ConAir: The Quest for Reasonable Office Air Con</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-09-14T21:22:00+02:00" pubdate data-updated="true">Sep 14<sup>th</sup>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>We’re all pretty genial people in our office, however, together with car parking,
one of the topics that is always likely to get a response is the air conditioning.
It’s a regular occurrence for people to be sat coding in their coats, but equally
the meeting cupboard suffers from what can only be described as sauna-like properties.</p>

<p>I decided that I needed to buy a thermometer. I find that life is better with more
data, and that we would all feel a lot better with some facts to backup our complaints.</p>

<h2 id="why-buy-a-thermometer-when-you-can-make-one">Why buy a thermometer, when you can make one?</h2>

<p>I didn’t really want to just measure the temperature, I wanted to chart it. I wanted a
chart of the temperature in lots of different places, all the time. I didn’t want to
spend all day typing readings into a spreadsheet, so I needed to log it automatically.
I needed an Arduino. Luckily my colleague had one - I ordered a thermistor and we were
away.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2012/09/14/conair-the-quest-for-reasonable-office-air-con/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/09/04/welcome-to-fibre-broadband/">Welcome to Fibre Broadband!</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-09-04T22:19:00+02:00" pubdate data-updated="true">Sep 4<sup>th</sup>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Having been pretty happy with many years of standard ADSL at about 5 MBit/s, pretty
reasonable for UK standards, we decided a week ago to upgrade to fibre optic. Well,
I say fibre optic, we don’t get magic cool looking fibres in our house:</p>

<p><img src="http://images.cdn.fotopedia.com/jupilucha-YQHsftL0-qY-hd.jpg" /></p>

<p>but rather there is a fibre optic cable to the cabinet down the road. The same old
twisted pair copper is used to get the actual internet into our house.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2012/09/04/welcome-to-fibre-broadband/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  <div class="pagination">
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/3">Newer &rarr;</a>
    
  </div>
</div>


    </div>
  </div>
  <footer role="contentinfo"><ul>
  <li>
    <a href="/atom.xml">RSS</a>
  </li>
  <li>
    <a href="https://twitter.com/iwantmyrealname">twitter</a>
  </li>
  <li>
    <a href="https://app.net/samd">adn</a>
  </li>
  <li>
    <a href="https://plus.google.com/101617378418592701939/posts">g+</a>
  </li>
  <li>
    <a href="https://github.com/sammyd">github</a>
  </li>
  <li>
    Copyright &copy; 2014 - Sam Davies -
    <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
  </li>
</ul>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'iwantmyrealname';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>





  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
